"use strict";(self.webpackChunkproject_bni_dashboard=self.webpackChunkproject_bni_dashboard||[]).push([[7878],{77878:function(e,n,t){t.r(n),t.d(n,{default:function(){return q}});var r=t(34148),o=t(85640),a=t(1413),i=t(42982),s=t(15861),c=t(70885),l=t(87757),d=t.n(l),u=t(46759),g=t(32916),p=t(30936),h=t(79032),m=function(e){return(0,p.by)("/public/bannercarousel/"+e,h.Ik.GET,void 0,void 0)},f=t(46417),x=function(e){var n=e.wrapperProps,t=e.id,o=(0,u.useState)([]),l=(0,c.Z)(o,2),p=(l[0],l[1]),h=function(){var e=(0,s.Z)(d().mark((function e(n){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(n);case 3:return(t=e.sent).content&&p((function(e){return[].concat((0,i.Z)(e),[t.content])})),e.abrupt("return",t.content);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n){return e.apply(this,arguments)}}();return(0,u.useMemo)((function(){var e=Array.from({length:5},(function(e,n){return n+1}));Promise.all(e.map((function(e){return h(e)})))}),[]),(0,f.jsxs)(r.Flex,(0,a.Z)((0,a.Z)({maxWidth:{md:1e3},overflow:"hidden",marginTop:{base:-8,md:-12},alignItems:"center",justifyContent:"center"},n),{},{children:[(0,f.jsx)(r.IconButton,{id:"".concat(t,"-carousel-prev-btn"),"aria-label":"prev",backgroundColor:"orange.500",_hover:{bg:"orange.600"},color:"white",icon:(0,f.jsx)(g.Ao2,{size:24,fontWeight:700}),className:"carousel-button-prev",zIndex:2,marginRight:-10,display:{base:"none",md:"inherit"}}),(0,f.jsx)(r.IconButton,{id:"".concat(t,"-carousel-next-btn"),"aria-label":"next",bg:"orange.500",width:12,_hover:{bg:"orange.600"},color:"white",icon:(0,f.jsx)(g.Rgz,{size:24,fontWeight:700}),className:"carousel-button-next",marginLeft:-10,zIndex:2,display:{base:"none",md:"inherit"}})]}))},b=t(67630),v="./".concat(b.ur,"/images/banners/"),j=["banner1.png","banner2.png","banner3.png","banner4.png"].map((function(e){return"".concat(v).concat(e)})),k=function(e){var n=e.children,t="\n    radial-gradient(\n      55% 41.59% at 50% 49.47%, \n      rgba(0, 102, 119, 0) 0%, \n      #006677 100%\n    ), \n    url('./".concat(b.ur,"/images/homepage.png')\n  ");return(0,f.jsxs)(r.Flex,{flexDirection:"column",px:{lg:32,sm:22},gap:{base:8,md:20},justifyContent:"center",alignItems:"center",my:{base:0,md:20},children:[(0,f.jsx)(r.Box,{backgroundImage:t,backgroundPosition:"center",backgroundRepeat:"no-repeat",maxH:{lg:"130vh",xl:"150vh","2xl":"120vh"},backgroundSize:"cover",bgPosition:"top",position:"absolute",display:{base:"none",md:"block"},top:0,left:0,width:"100%",height:"100%",zIndex:-1}),(0,f.jsxs)(r.Grid,{templateColumns:{base:"1fr",md:"7fr 5fr"},gap:{sm:12,xl:28},width:"full",alignItems:"flex-start",children:[(0,f.jsx)(r.Flex,{}),(0,f.jsx)(r.Grid,{paddingY:{base:8},paddingX:{base:4,md:8},backgroundColor:"white",borderRadius:{md:16},gap:8,alignSelf:"end",children:n})]}),(0,f.jsxs)(r.Flex,{flexDirection:"column",gap:"8",width:"full",paddingBottom:{base:20,md:0},alignItems:{xl:"center"},children:[(0,f.jsx)(r.Heading,{fontSize:"3xl",textAlign:"center",textColor:{md:"white"},children:(0,f.jsx)(o.FormattedMessage,{id:"Promotion"})}),(0,f.jsx)(x,{images:j,id:"promotion-banner"})]})]})},I=t(14790),w=t(49016),y=t(55159),Z=t(65871),C=t(10190),F=t(39835),S=t(51265),L=t(78622),M=t(7578),z=t(45470),P=function(){var e=(0,s.Z)(d().mark((function e(n){var t,r,o,i,s,c,l;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.username,i=n.password,s=n.captcha,e.next=3,(0,M.Z)();case 3:return c=e.sent,l=null!==(t=null===(r=c.content)||void 0===r?void 0:r.publicKey)&&void 0!==t?t:"",e.abrupt("return",(0,L._)({url:"".concat(h.H,"/").concat("login"),method:"POST",headers:(0,a.Z)((0,a.Z)({},p.Pk),{},{Authorization:(0,z.bS)(o,i,l),companyId:n.companyId,otp:(0,z.vC)(s,l)})}));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=P,D=t(32231),T=t(76291),B=t.n(T),G=t(39009),H=B()()((0,G.tJ)((function(e){return{image:"",setImage:function(n){return e({image:n})},clear:function(){return e({image:""})}}}),{name:"captcha"})),R=t(78310),W=R.object({companyId:R.string().required(),username:R.string().required(),password:R.string().required(),captcha:R.string().optional()}),A=function(){var e=(0,o.useIntl)(),n=(0,Z.useSWRConfig)().cache,t=H(),i=t.image,l=t.setImage,p=u.useState(!1),m=(0,c.Z)(p,2),x=m[0],b=m[1],v=u.useState(!1),j=(0,c.Z)(v,2),k=j[0],M=j[1],P=u.useState(null),T=(0,c.Z)(P,2),B=T[0],G=T[1],R=u.useState(0),A=(0,c.Z)(R,2),q=A[0],E=A[1],X=(0,D.a)((function(e){return[e.token,e.setToken,e.setCompanyId,e.setUser,e.setFirstTimeLogin]}),C.Z),N=(0,c.Z)(X,5),V=N[0],Y=N[1],J=N[2],K=N[3],O=N[4],U=(0,w.useForm)({mode:"onChange",resolver:(0,I.X)(W)}),Q=U.register,$=U.handleSubmit,ee=U.getValues,ne=U.formState,te=ne.isDirty,re=ne.isValid,oe=function(){var e=(0,s.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ee(),b(!0),e.next=4,(t={corporateId:n.companyId,userId:n.username},(0,L._)({url:"".concat(h.H,"/").concat("public/captcha","/").concat(t.corporateId,"/").concat(t.userId),method:h.Ik.GET})).then((function(e){var n,t,r=null===e||void 0===e||null===(n=e.content)||void 0===n?void 0:n.otp,o=null===e||void 0===e||null===(t=e.content)||void 0===t?void 0:t.requestInterval;l(r),E(o)})).finally((function(){b(!1)}));case 4:case"end":return e.stop()}var t}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=(0,s.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ee(),n.clear(),!re||!t){e.next=6;break}return b(!0),e.next=6,_((0,a.Z)((0,a.Z)({},t),{},{captcha:B})).then((function(e){var n,r=null===e||void 0===e||null===(n=e.headers)||void 0===n?void 0:n.access_token;J(t.companyId),K((0,z.aj)(r)),Y(r),O(!0)})).catch((function(){oe(),G(null)})).finally((function(){b(!1)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u.useEffect((function(){var e=setInterval((function(){q>0&&E(q-1)}),1e3);return function(){return clearInterval(e)}}),[q]),V?(0,f.jsx)(S.Z,{}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.HStack,{children:[k&&(0,f.jsx)(r.Button,{id:"login-form-back-btn",variant:"ghost",color:"gray.400",leftIcon:(0,f.jsx)(g.Ao2,{size:24}),paddingX:0,_hover:{bgColor:"transparent"},onClick:function(){return M(!1)}}),(0,f.jsx)(r.Heading,{fontSize:"2xl",children:(0,f.jsx)(o.FormattedMessage,{id:"loginTitle"})})]}),(0,f.jsxs)(r.Flex,{gap:4,direction:"column",children:[(0,f.jsxs)(r.Grid,{gap:4,children:[(0,f.jsx)(F.Z,(0,a.Z)({id:"login-form-input-corporate-id",label:(0,f.jsx)(o.FormattedMessage,{id:"corpIdLoginLabel"}),placeholder:e.formatMessage({id:"corpIdLoginPlaceholder"}),isDisabled:k},Q("companyId"))),(0,f.jsx)(F.Z,(0,a.Z)({id:"login-form-input-user-id",label:(0,f.jsx)(o.FormattedMessage,{id:"userIdLoginLabel"}),placeholder:e.formatMessage({id:"userIdLoginPlaceholder"}),isDisabled:k},Q("username"))),(0,f.jsx)(F.Z,(0,a.Z)({id:"login-form-input-password",label:(0,f.jsx)(o.FormattedMessage,{id:"passwordLoginLabel"}),placeholder:e.formatMessage({id:"passwordLoginPlaceholder"}),isDisabled:k,type:"password"},Q("password"))),k&&(0,f.jsxs)(r.Flex,{flexDirection:"column",gap:4,mt:4,children:[(0,f.jsx)(r.Box,{backgroundImage:'url("data:image/png;base64,'.concat(i,'")'),backgroundRepeat:"no-repeat",bgPosition:"center left",bgSize:"75%",width:"50%",height:12}),(0,f.jsx)(r.Flex,{gap:8,children:q>0?(0,f.jsx)(r.Text,{color:"GrayText",children:(0,f.jsx)(o.FormattedMessage,{id:"refreshCaptchaInSecond",values:{count:q}})}):(0,f.jsx)(r.Link,{id:"login-form-refresh-captcha-link",color:"orange.500",fontWeight:"bold",onClick:function(){return oe()},children:(0,f.jsx)(o.FormattedMessage,{id:"refreshCaptcha"})})}),(0,f.jsx)(F.Z,{id:"login-form-input-captcha",onChange:function(e){return G(e.target.value)},placeholder:e.formatMessage({id:"captcha"}),value:null!==B&&void 0!==B?B:""})]})]}),(0,f.jsx)(r.Divider,{borderColor:"orange.100",marginY:8}),(0,f.jsxs)(r.Flex,{alignItems:"center",gap:"8",justifyContent:"space-between",children:[(0,f.jsx)(r.Link,{id:"login-form-forgot-password-link",as:y.Link,to:"/forgot-password",fontWeight:"bold",color:"orange.500",children:(0,f.jsx)(o.FormattedMessage,{id:"forgotPasswordTitle"})}),k?(0,f.jsx)(r.Button,{id:"login-btn",color:"white",isDisabled:!te||!re||x||!B,isLoading:x,_hover:{backgroundColor:"gray.600"},onClick:$(ae),width:{base:40,md:180},children:(0,f.jsx)(o.FormattedMessage,{id:"login"})}):(0,f.jsx)(r.Button,{id:"login-form-next-btn",color:"white",isDisabled:!te||!re||x,isLoading:x,_hover:{backgroundColor:"gray.600"},onClick:function(){oe(),M(!0)},width:{base:40,md:180},children:(0,f.jsx)(o.FormattedMessage,{id:"next"})})]})]})]})},q=function(){return(0,f.jsx)(k,{children:(0,f.jsx)(A,{})})}}}]);