"use strict";(self.webpackChunkproject_bni_dashboard=self.webpackChunkproject_bni_dashboard||[]).push([[6561],{36561:function(e,t,n){n.d(t,{Z:function(){return S}});var a=n(1413),o=n(70885),i=n(34148),l=n(2789),d=n(75474),r=n(72165),s=n(46759),c=n(60860),u=n(85640),m=n(46417),v=function(e){var t=e.time,n=void 0!==t&&t,a=e.formDefault,o=void 0===a?{name:null,allDay:!1,description:null,endDate:new Date,startDate:new Date,endTime:null,startTime:null}:a,d=e.id,r=(0,u.useIntl)();return(0,m.jsxs)(i.Flex,{flexDirection:"column",gap:"6",children:[(0,m.jsxs)(i.FormControl,{children:[(0,m.jsx)(i.FormLabel,{htmlFor:"".concat(d,"-calendar-form-input-event-title"),children:(0,m.jsx)(u.FormattedMessage,{id:"eventTitle"})}),(0,m.jsx)(i.Input,{id:"".concat(d,"-calendar-form-input-event-title"),type:"text",h:"12",name:"name",borderRadius:0,defaultValue:(null===o||void 0===o?void 0:o.name)||"",placeholder:r.formatMessage({id:"eventTitlePlaceholder"}),isRequired:!0})]}),(0,m.jsxs)(i.FormControl,{children:[(0,m.jsx)(i.FormLabel,{htmlFor:"".concat(d,"-calendar-form-input-event-description"),children:(0,m.jsx)(u.FormattedMessage,{id:"eventDescription"})}),(0,m.jsx)(i.Textarea,{id:"".concat(d,"-calendar-form-text-area-event-description"),h:"12",name:"description",borderRadius:0,defaultValue:(null===o||void 0===o?void 0:o.description)||"",placeholder:r.formatMessage({id:"eventDescriptionPlaceholder"}),isRequired:!0})]}),(0,m.jsxs)(i.FormControl,{children:[(0,m.jsx)(i.FormLabel,{htmlFor:"".concat(d,"-calendar-form-input-start-date"),children:(0,m.jsx)(u.FormattedMessage,{id:"eventStart"})}),(0,m.jsx)(i.Input,{id:"".concat(d,"-calendar-form-input-start-date"),type:"date",h:"12",name:"startDate",borderRadius:0,defaultValue:(0,l.format)(new Date((null===o||void 0===o?void 0:o.startDate)||new Date),"yyyy-MM-dd"),placeholder:"Tanggal Mulai Event",isRequired:!0})]}),n&&(0,m.jsxs)(i.FormControl,{children:[(0,m.jsx)(i.FormLabel,{htmlFor:"".concat(d,"-calendar-form-input-end-date"),children:(0,m.jsx)(u.FormattedMessage,{id:"eventEnd"})}),(0,m.jsx)(i.Input,{defaultValue:(0,l.format)(new Date((null===o||void 0===o?void 0:o.endDate)||new Date),"yyyy-MM-dd"),id:"".concat(d,"-calendar-form-input-end-date"),type:"date",h:"12",name:"endDate",borderRadius:0,placeholder:"Tanggal Selesai Event",isRequired:!0})]}),!n&&(0,m.jsxs)(i.Flex,{gap:6,children:[(0,m.jsxs)(i.FormControl,{children:[(0,m.jsx)(i.FormLabel,{htmlFor:"".concat(d,"-calendar-form-input-start-time"),children:(0,m.jsx)(u.FormattedMessage,{id:"eventTimeStart"})}),(0,m.jsx)(i.Input,{id:"".concat(d,"-calendar-form-input-start-time"),type:"time",defaultValue:o.startTime?o.startTime:(0,l.format)(new Date,"HH:ss"),h:"12",name:"startTime",borderRadius:0,placeholder:"Waktu Mulai",isRequired:!0})]}),(0,m.jsxs)(i.FormControl,{children:[(0,m.jsx)(i.FormLabel,{htmlFor:"".concat(d,"-calendar-form-input-end-time"),children:(0,m.jsx)(u.FormattedMessage,{id:"eventTimeEnd"})}),(0,m.jsx)(i.Input,{id:"".concat(d,"-calendar-form-input-end-time"),defaultValue:o.endTime?o.endTime:(0,l.format)(new Date,"HH:ss"),type:"time",h:"12",name:"endTime",borderRadius:0,placeholder:"Waktu Selesai",isRequired:!0})]})]})]})},x=n(62305),f=n(30936),h=function(e){return(0,f.S0)("calendar/add","POST","",e)},j=n(55170),p=n(32231),D=n(19544),g=function(e){var t,n=e.mutate,d=e.id,r=(0,i.useDisclosure)(),c=r.isOpen,f=r.onOpen,g=r.onClose,M=(0,D.G)(),b=M.selectDate,y=M.params,w=(0,i.useBreakpointValue)({base:"full",md:"md"}),F=(0,s.useState)(!1),C=(0,o.Z)(F,2),T=C[0],k=C[1],Z=(0,s.useState)(!1),B=(0,o.Z)(Z,2),S=B[0],H=B[1],E=(0,x.T)(),I=(0,p.a)().user,O=(0,u.useIntl)(),R=(0,j.H)(y,!0).mutate,L=null===I||void 0===I||null===(t=I.additionalInfo)||void 0===t?void 0:t.menuList.find((function(e){return"MNU_CUST_HUB_CALENDAR"===e.id})),_=function(){H(!1),g()};return(0,m.jsxs)(m.Fragment,{children:[!(null!==L&&void 0!==L&&L.viewOnly)&&(0,m.jsx)(i.Button,{id:"".concat(d,"-create-corporate-event-btn"),mt:6,h:14,w:"full",bg:"#3A3A3A",color:"white",_hover:{bg:"black"},onClick:f,children:(0,m.jsx)(u.FormattedMessage,{id:"createEvent"})}),(0,m.jsxs)(i.Modal,{id:"".concat(d,"-create-event-modal"),isOpen:c,size:w,onClose:_,isCentered:!0,children:[(0,m.jsx)(i.ModalOverlay,{}),(0,m.jsxs)(i.ModalContent,{borderRadius:0,children:[(0,m.jsx)(i.ModalHeader,{children:(0,m.jsx)(u.FormattedMessage,{id:"createEvent"})}),(0,m.jsx)(i.ModalCloseButton,{id:"".concat(d,"-create-event-modal-close-btn")}),(0,m.jsx)(i.ModalBody,{children:(0,m.jsxs)("form",{id:"".concat(d,"-create-event-modal-form"),onSubmit:function(e){var t,o,i;e.preventDefault(),k(!0);var d=new FormData(e.currentTarget),r=Object.fromEntries(d.entries()),s=new Date(new Date(r.startDate).setHours(0,0,0,0)),c=new Date(new Date(!1===S?r.startDate:null!==(t=r.endDate)&&void 0!==t?t:r.startDate).setHours(0,0,0,0)),u=(0,a.Z)((0,a.Z)({},r),{},{allDay:S,startDate:(0,l.format)(s,"dd-MM-yyyy"),endDate:(0,l.format)(c,"dd-MM-yyyy"),startTime:null!==(o=r.startTime)&&void 0!==o?o:(0,l.format)(new Date,"HH:ss"),endTime:null!==(i=r.endTime)&&void 0!==i?i:(0,l.format)(new Date,"HH:ss")});s>c?(E({status:"warning",description:"Tanggal selesai tidak boleh kurang dari tanggal mulai."}),k(!1)):h(u).then((function(){n(),R(),E({status:"success",description:O.formatMessage({id:"successAddEvents"})}),H(!1),k(!1),_()})).catch((function(){k(!1)}))},children:[(0,m.jsx)(v,{id:"".concat(d,"-create-event-modal"),time:S,formDefault:{startDate:new Date(b||new Date),endDate:new Date(b||new Date)}}),(0,m.jsx)(i.Checkbox,{id:"".concat(d,"-create-event-modal-checkbox-all-day"),mt:4,name:"allDay",onChange:function(e){H(e.target.checked)},children:(0,m.jsx)(u.FormattedMessage,{id:"allDay"})}),(0,m.jsx)(i.Box,{position:{base:"fixed",md:"unset"},w:"full",bottom:0,right:0,px:{base:8,md:0},children:(0,m.jsxs)(i.Flex,{gap:5,my:6,children:[(0,m.jsx)(i.Button,{id:"".concat(d,"-create-event-modal-cancel-btn"),onClick:_,variant:"outline",w:"full",children:(0,m.jsx)(u.FormattedMessage,{id:"cancel"})}),(0,m.jsx)(i.Button,{id:"".concat(d,"-create-event-modal-create-event-btn"),w:"full",type:"submit",isLoading:T,children:(0,m.jsx)(u.FormattedMessage,{id:"createEventButton"})})]})})]})})]})]})]})},M=function(e){return(0,f.S0)("".concat("calendar/delete","/").concat(e),"POST")},b=function(e){var t,n,a=e.isOpen,o=e.onClose,l=e.id,d=e.events,r=e.mutate,s=e.componentId,c=d.find((function(e){return e.id===l})),v=(0,i.useBreakpointValue)({base:"full",md:"sm"}),x=(0,D.G)().params,f=(0,j.H)(x,!0).mutate,h=(0,i.useToast)(),p=(0,u.useIntl)();return(0,m.jsxs)(i.Modal,{id:"".concat(s,"-delete-event-modal"),isOpen:a,size:v,onClose:o,isCentered:!0,children:[(0,m.jsx)(i.ModalOverlay,{}),(0,m.jsxs)(i.ModalContent,{borderRadius:0,w:{base:"full",md:"sm"},children:[(0,m.jsxs)(i.Box,{borderBottom:"full"===v?"1px solid #dedede":"",children:[(0,m.jsx)(i.ModalHeader,{children:(0,m.jsx)(u.FormattedMessage,{id:"deleteEvent"})}),"full"===v&&(0,m.jsx)(i.Text,{px:"6",mb:"5",children:null!==(t=null===c||void 0===c?void 0:c.name)&&void 0!==t?t:""})]}),(0,m.jsx)(i.ModalCloseButton,{id:"".concat(s,"-delete-event-modal-close-btn")}),(0,m.jsx)(i.ModalBody,{children:(0,m.jsxs)(i.Box,{children:[(0,m.jsx)(i.Text,{children:(0,m.jsx)(u.FormattedMessage,{id:"deleteEventConfirmation"})}),(0,m.jsxs)(i.Box,{mt:3,p:4,border:"1px solid #dedede",children:[(0,m.jsx)(i.Heading,{size:"sm",children:null!==(n=null===c||void 0===c?void 0:c.name)&&void 0!==n?n:""}),null!==c&&void 0!==c&&c.description?(0,m.jsx)(i.Text,{children:"".concat(null===c||void 0===c?void 0:c.description.slice(0,80)).concat(((null===c||void 0===c?void 0:c.description.length)||0)>80?"...":"")}):""]})]})}),(0,m.jsxs)(i.ModalFooter,{gap:5,children:[(0,m.jsx)(i.Button,{id:"".concat(s,"-delete-event-modal-cancel-btn"),onClick:o,variant:"outline",w:"full",children:(0,m.jsx)(u.FormattedMessage,{id:"cancel"})}),(0,m.jsx)(i.Button,{id:"".concat(s,"-delete-event-modal-delete-btn"),variant:"outline",w:"full",onClick:function(){M(l||"").then((function(){f(),r(),h({description:p.formatMessage({id:"successDeleteEvents"}),status:"success",duration:5e3,isClosable:!0})})),o()},children:(0,m.jsx)(u.FormattedMessage,{id:"delete"})})]})]})]})},y=function(e){return(0,f.S0)("calendar/edit","POST","",e)},w=function(e){var t,n=e.isOpen,d=e.onClose,r=e.id,c=e.mutate,f=e.componentId,h=(0,i.useBreakpointValue)({base:"full",md:"md"}),p=(0,s.useState)(null),g=(0,o.Z)(p,2),M=g[0],b=g[1],w=(0,s.useState)(!1),F=(0,o.Z)(w,2),C=F[0],T=F[1],k=(0,x.T)(),Z=(0,u.useIntl)(),B=(0,D.G)().params,S=(0,j.H)(B,!0),H=S.data,E=S.mutate;if(null===H||void 0===H||!H.content)return null;var I=null===H||void 0===H||null===(t=H.content)||void 0===t?void 0:t.find((function(e){return e.id===r})),O=null===M?null===I||void 0===I?void 0:I.allDay:M,R=function(){b(null),d()};return(0,m.jsxs)(i.Modal,{id:"".concat(f,"-edit-event-modal"),isOpen:n,size:h,onClose:R,isCentered:!0,children:[(0,m.jsx)(i.ModalOverlay,{}),(0,m.jsxs)(i.ModalContent,{borderRadius:0,children:[(0,m.jsx)(i.ModalHeader,{children:(0,m.jsx)(u.FormattedMessage,{id:"editEvent"})}),(0,m.jsx)(i.ModalCloseButton,{id:"".concat(f,"-edit-event-modal-close-btn")}),(0,m.jsx)(i.ModalBody,{children:(0,m.jsxs)("form",{id:"".concat(f,"-edit-event-modal-form"),onSubmit:function(e){var t,n;e.preventDefault(),T(!0);var o=new FormData(e.currentTarget),i=Object.fromEntries(o.entries()),d=new Date(new Date(i.startDate).setHours(0,0,0,0)),s=new Date(new Date(O?new Date(null!==(t=i.endDate)&&void 0!==t?t:new Date):new Date(null!==(n=i.startDate)&&void 0!==n?n:new Date)).setHours(0,0,0,0));if(d>s)k({status:"warning",description:"Tanggal selesai tidak boleh kurang dari tanggal mulai."}),T(!1);else{var u,m,v=(0,a.Z)((0,a.Z)({},i),{},{id:r,allDay:O,startDate:(0,l.format)(d,"dd-MM-yyyy"),endDate:(0,l.format)(s,"dd-MM-yyyy"),startTime:null!==(u=i.startTime)&&void 0!==u?u:(0,l.format)(new Date,"HH:ss"),endTime:null!==(m=i.endTime)&&void 0!==m?m:(0,l.format)(new Date,"HH:ss")});y(v).then((function(){c(),E(),k({status:"success",description:Z.formatMessage({id:"successEditEvents"})}),b(null),T(!1),R()})).catch((function(){T(!1)}))}},children:[(0,m.jsx)(v,{id:"".concat(f,"-edit-event-modal"),time:null!==O&&void 0!==O&&O,formDefault:I}),(0,m.jsx)(i.Checkbox,{id:"".concat(f,"-edit-event-modal-checkbox-all-day"),mt:4,name:"allDay",defaultChecked:null===I||void 0===I?void 0:I.allDay,onChange:function(e){b(e.target.checked)},children:(0,m.jsx)(u.FormattedMessage,{id:"allDay"})}),(0,m.jsx)(i.Box,{position:{base:"fixed",md:"unset"},w:"full",bottom:0,right:0,px:{base:8,md:0},children:(0,m.jsxs)(i.Flex,{gap:5,my:6,children:[(0,m.jsx)(i.Button,{id:"".concat(f,"-edit-event-modal-cancel-btn"),onClick:R,variant:"outline",w:"full",children:(0,m.jsx)(u.FormattedMessage,{id:"cancel"})}),(0,m.jsx)(i.Button,{id:"".concat(f,"-edit-event-modal-save-btn"),w:"full",type:"submit",isLoading:C,children:(0,m.jsx)(u.FormattedMessage,{id:"save"})})]})})]})})]})]})},F=n(79032),C="calendarview/nextmonth",T=n(54607),k=n(42982),Z=function(e){var t,n,a,o=e.setColapse,s=e.colSelect,v=e.item,x=e.onEdit,f=e.onDelete,h=e.isWidget,j=e.componentId,D=(0,T.b)().locale,g=(0,p.a)().user,M=null===g||void 0===g||null===(t=g.additionalInfo)||void 0===t?void 0:t.menuList.find((function(e){return"MNU_CUST_HUB_CALENDAR"===e.id}));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(i.Flex,{id:"".concat(j,"-open-close-btn"),justify:"space-between",alignItems:"center",cursor:"pointer",onClick:function(){return function(e){if(s.find((function(t){return t===e}))){var t=s.filter((function(t){return t!==e}));o(t)}else o([].concat((0,k.Z)(s),[e]))}(v.id)},children:[(0,m.jsxs)(i.Box,{children:[(0,m.jsx)(i.Text,{textTransform:"capitalize",fontWeight:600,children:v.name}),(0,m.jsxs)(i.Text,{children:[(0,l.format)(new Date(null!==(n=null===v||void 0===v?void 0:v.startDate)&&void 0!==n?n:""),"yyyy MMM dd",{locale:"id"===D?d.Z:r.Z})," ","-"," ",(0,l.format)(new Date(null!==(a=null===v||void 0===v?void 0:v.endDate)&&void 0!==a?a:""),"yyyy MMM dd",{locale:"id"===D?d.Z:r.Z})]})]}),s.includes(v.id)?(0,m.jsx)(c.OId,{}):(0,m.jsx)(c.Vmf,{})]}),(0,m.jsx)(i.Collapse,{id:"".concat(j,"-collapse"),startingHeight:0,in:s.includes(v.id),animateOpacity:!0,children:(0,m.jsxs)(i.Box,{children:[(0,m.jsx)(i.Text,{mt:2,mb:3,children:v.description}),!h&&!(null!==M&&void 0!==M&&M.viewOnly)&&!v.bo&&(0,m.jsxs)(i.Flex,{w:"full",flexDirection:"row-reverse",children:[(0,m.jsx)(i.Button,{id:"".concat(j,"-delete-event-btn"),variant:"outline",border:"0px",color:"gray.400",onClick:f,children:(0,m.jsx)(u.FormattedMessage,{id:"deleteEventButton"})}),(0,m.jsx)(i.Button,{id:"".concat(j,"-edit-event-btn"),variant:"outline",border:"0px",onClick:x,children:(0,m.jsx)(u.FormattedMessage,{id:"editEventButton"})})]})]})})]})},B=n(1896),S=function(e){var t=e.isWidget,n=void 0!==t&&t,v=e.componentId,x=(0,u.useIntl)(),h=(0,T.b)().locale,j=(0,D.G)(),p=j.selectDate,M=j.resetSelect,y=j.currentData,k=(0,s.useState)([]),S=(0,o.Z)(k,2),H=S[0],E=S[1],I=(0,s.useState)({delete:null,edit:null}),O=(0,o.Z)(I,2),R=O[0],L=O[1],_=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,f.eZ)({path:C,method:F.Ik.GET,params:e,isReady:t})}(void 0,!0),V=_.data,A=_.mutate,z=(null===V||void 0===V?void 0:V.content)||[],G=p?null===y||void 0===y?void 0:y.filter((function(e){return new Date(p||"")<=new Date(e.endDate)&&new Date(e.startDate)<=new Date(p||"")})):z.filter((function(e){return(0,l.isSameMonth)(new Date(e.startDate),new Date)||(0,l.subMonths)(new Date,1)}));null===G||void 0===G||G.sort((function(e,t){return+new Date(e.startDate)-+new Date(t.startDate)}));var U=function(e){return function(){return L((0,a.Z)((0,a.Z)({},R),{},{delete:e}))}},W=function(e){return function(){return L((0,a.Z)((0,a.Z)({},R),{},{edit:e}))}},q=function(e){return function(){"edit"===e&&L((0,a.Z)((0,a.Z)({},R),{},{edit:null})),"delete"===e&&L((0,a.Z)((0,a.Z)({},R),{},{delete:null}))}};return(0,m.jsxs)(i.Box,{w:n?"full":{base:"full",md:"2xl"},p:6,bg:"white",maxH:"lg",overflowY:"scroll",children:[p&&(0,m.jsxs)(i.Flex,{id:"".concat(v,"-event-back-to-event-btn"),onClick:M,cursor:"pointer",alignItems:"center",gap:2,mb:3,children:[(0,m.jsx)(c.u1R,{size:18}),(0,m.jsxs)(i.Text,{fontWeight:"bold",children:[(0,m.jsx)(u.FormattedMessage,{id:"backToEvents"})," ",(0,l.format)(new Date(null!==p&&void 0!==p?p:new Date),"MMM yyyy",{locale:"id"===h?d.Z:r.Z})," "]})]}),!n&&(0,m.jsx)(i.Heading,{fontSize:{base:18,md:21},mb:6,children:p?"":x.formatMessage({id:"UpcomingEvents"})}),V?(0,m.jsxs)(i.List,{id:"".concat(v,"-event-list"),spacing:3,mt:n?0:8,children:[(0,m.jsx)(i.Text,{textAlign:"center",children:0===(null===G||void 0===G?void 0:G.length)&&p?x.formatMessage({id:"emptyDate"}):0===(null===G||void 0===G?void 0:G.length)?x.formatMessage({id:"emptyMonth"}):""}),null===G||void 0===G?void 0:G.map((function(e){return(0,m.jsx)(i.ListItem,{id:"".concat(v,"-event-list-item-").concat((0,B.R)(e.name)),border:"1px solid",borderColor:"orange.500",p:3,children:(0,m.jsx)(Z,{componentId:"".concat(v,"-event-list-item-").concat((0,B.R)(e.name)),setColapse:E,colSelect:null!==H&&void 0!==H?H:[],onDelete:U(e.id),onEdit:W(e.id),item:e,isWidget:n})},e.id)}))]}):(0,m.jsxs)(i.Stack,{children:[(0,m.jsx)(i.Skeleton,{height:"70px"}),(0,m.jsx)(i.Skeleton,{height:"70px"}),(0,m.jsx)(i.Skeleton,{height:"70px"})]}),!n&&(0,m.jsx)(g,{id:"".concat(v,"-event"),mutate:A}),(0,m.jsx)(w,{componentId:"".concat(v,"-event"),isOpen:null!==R.edit,id:R.edit,events:z,onClose:q("edit"),mutate:A}),(0,m.jsx)(b,{componentId:"".concat(v,"-event"),isOpen:null!==R.delete,id:R.delete,events:z,mutate:A,onClose:q("delete")})]})}},55170:function(e,t,n){n.d(t,{H:function(){return l}});var a=n(30936),o=n(79032),i="calendarview",l=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,a.eZ)({path:i,method:o.Ik.GET,params:e,isReady:t})}},19544:function(e,t,n){n.d(t,{G:function(){return c}});var a=n(1413),o=n(2789),i=n(75474),l=n(76291),d=n.n(l),r=n(39009),s={selectDate:null,selectMonth:(0,o.startOfMonth)(new Date),currentData:null,params:{month:+(0,o.format)(new Date,"MM",{locale:i.Z}),year:+(0,o.format)(new Date,"yyyy",{locale:i.Z})}},c=d()()((0,r.tJ)((function(e){return(0,a.Z)((0,a.Z)({},s),{},{setCurrentData:function(t){return e({currentData:t})},setSelectDate:function(t){return e({selectDate:t})},resetSelect:function(){return e({selectDate:null})},setSelectMonth:function(t){return e({selectMonth:t})},setParams:function(t){return e({params:{month:+(0,o.format)(t,"MM",{locale:i.Z}),year:+(0,o.format)(t,"yyyy",{locale:i.Z})}})}})}),{name:"calendar"}))}}]);